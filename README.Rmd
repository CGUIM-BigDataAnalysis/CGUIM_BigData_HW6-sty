---
title: "居安思維-桃園"
output: github_document
---

組員姓名：游思亭

## 分析議題背景
禮運大同篇：「....是故謀閉而不興，盜竊亂賊而不作，故外戶而不閉，是謂『大同』。」在每個人心中都有個小烏托邦。然而，近幾年來卻發生了許多社會事件，導致普羅大眾人心惶惶。

## 分析動機
從古至今人們即在追求居安的生活品質，不論老少都需要一個安全穩定居住品質。因此，想要了解桃園市的優質居住區域，藉由犯罪資料來分析出較適合的居住空間。

## 使用資料
1. 105年犯罪資料
2. 桃園市狹小巷弄

載入使用資料們
```{r}
#這是R Code Chunk
# 載入犯罪資料
library(readr)
cridata0103 <- read_csv("~/Desktop/105犯罪資料/10501-10503criminaldata.csv.xls")
cridata0406 <- read_csv("~/Desktop/105犯罪資料/10504-10506criminaldata.csv.xls")
cridata0709 <- read_csv("~/Desktop/105犯罪資料/10507-10509criminaldata.csv.xls")
cridata1012 <- read_csv("~/Desktop/105犯罪資料/10510-10512criminaldata.csv.xls")
# 載入狹小巷弄（潛在危險）
narrowalley <- read_csv("~/Desktop/潛在危險/NarrowAlleyTY.csv")
```

## 資料處理與清洗
・105年犯罪資料 cridata0112_ty

讀取下的105年犯罪資料以每季作為區隔，且為全台犯罪紀錄資料。先將每季犯罪資料合併，刪除多於欄位X4，並將欄位名稱重新命名，以防字元錯誤的問題發生。篩選出桃園市犯罪資料，檢查發生地點欄位值的內容發現有“桃園市”及“桃園市桃園區”的存在，兩者應為同一欄位內容，為保留“桃園市桃園區”，因此先判斷欄位值是否為“桃園市”，並新增欄位index，最後將欄位值為“桃園市”的資料改為“桃園市桃園區”。

   step1. 將合併每季犯罪資料 
   
   step2. 將犯罪資料第四欄位X4去除 
   
   step3. 更改cridata0112_tw欄位名稱: Type, Date, Site 
   
   step4. 將桃園市所有犯罪資料篩選出 
   
   step5. 將cridata0112_ty的發生地點“桃園市”改為“桃園市桃園區”


・狹小巷弄資料 narrowalley_ty

備份狹小巷弄資料narrowalley_ty，並將欄位名稱重新命名，以防字元錯誤的問題發生。

   step1. 將narrowalley備份 
   
   step2. 更改narrowalley_ty欄位名稱: Site, Address
   
處理資料
```{r}
#這是R Code Chunk
# 1. 105年犯罪資料
# 合併每季犯罪資料 
# cridata0112
cridata0112 <- rbind(cridata0103,cridata0406,cridata0709,cridata1012)
# 刪除第四欄位: X4
# cridata0112_tw
cridata0112_tw <- cridata0112[-4]
# 更改欄位名稱: Type, Date, Site
names(cridata0112_tw) <- c("Type","Date","Site")
# 將桃園市所有犯罪資料篩選出
# cridata0112_ty
cridata0112_ty <- cridata0112_tw[grep("桃園市",cridata0112_tw$Site),]
# 將發生地點為“桃園市”的資料篩選出 
# cridata0112_ty_T
 # 找出完全符合的欄位值,回傳Ｔ＆Ｆ
cridata0112_ty_T <- data.frame(cridata0112_ty$Site %in% "桃園市")
 # 更改欄位名稱: C
names(cridata0112_ty_T) <- "C"
 # 新增欄位名稱: index,新增欄位值: 1:8693
cridata0112_ty_T$index <- 1:8693
 # 將欄位Ｃ的值改為字串型態
cridata0112_ty_T$C <- as.character(cridata0112_ty_T$C)
 # 將欄位Ｃ的值改為"TRUE"的資料篩選出
cridata0112_ty_T <- cridata0112_ty_T[grep("TRUE",cridata0112_ty_T$C),]
# 將“桃園市”改為“桃園市桃園區” 
# cridata0112_ty
cridata0112_ty$Site[cridata0112_ty_T$index] <- "桃園市桃園區"
knitr::kable(cridata0112_ty)

# 2. 狹小巷弄資料
# 更改欄位名稱: Site, Address
# narrowalley_ty
narrowalley_ty <- narrowalley
# 更改欄位名稱: Site, Address
names(narrowalley_ty) <- c("Site","Address")
knitr::kable(narrowalley_ty)
```

## 探索式資料分析
圖文並茂圖文並茂
```{r}
#這是R Code Chunk
# 1. 105年犯罪資料
# 統計桃園各案類犯罪資料
# cridata0112_ty_type
cridata0112_ty_type <- data.frame(table(cridata0112_ty$Type))
# 更改欄位名稱: Type, Quantity
names(cridata0112_ty_type) <- c("Type","Quantity")
# 由大到小排序
cridata0112_ty_type <- cridata0112_ty_type[order(cridata0112_ty_type$Quantity, decreasing = TRUE),]
# 將Type欄位內容改為英文
cridata0112_ty_type$Type <- c("D","MT","MVT","B",
                               "R","FT","FSI")
criminaltype <- c("D: Drugs","MT: Motorcycle Theft",
                  "MVT: Motor Vehicle Theft", "B: Burglary",
                  "R: Robbery",
                  "FT: Forceful Taking",
                  "FSI: Forcible Sexual Intercourse")
# 分別將案類、數量取出
critype <- cridata0112_ty_type$Type
criquan <- cridata0112_ty_type$Quantity
# 將數量資料轉成matrix
matrix_cridata0112_ty_type <- matrix(criquan)
# 轉置matrix
matrix_cridata0112_ty_type <- t(matrix_cridata0112_ty_type)
# 更改欄位名
colnames(matrix_cridata0112_ty_type) <- critype
# 犯罪類型最高統計
knitr::kable(matrix_cridata0112_ty_type)
# 長條圖
barplot(matrix_cridata0112_ty_type, 
        xlab = "Criminal Type",
        ylab = "Quantity",
        col = "#FF7256",
        legend.text = criminaltype,
        width = 1, space = 0.1, main = "TaoYuan Criminal Type")
# 從上圖可以看出桃園市犯罪案件類型最高的為毒品

# 統計桃園各區發生犯罪的數量
# cridata0112_ty_site
cridata0112_ty_site <- data.frame(table(cridata0112_ty$Site))
# 更改欄位名稱: Site, Quantity
names(cridata0112_ty_site) <- c("Site","Quantity")
# 由大到小排序
cridata0112_ty_site <- cridata0112_ty_site[order(cridata0112_ty_site$Quantity, decreasing = TRUE),]
# 將“桃園市”取代為“”
cridata0112_ty_site$Site <- sub("桃園市","",cridata0112_ty_site$Site)
# 將Site欄位內容改為英文
cridata0112_ty_site$Site <- c("TY","JLI",
                              "BD","PJ",
                              "GS","LT",
                              "YM","DS",
                              "LJ","DY",
                              "GY","SW",
                              "FS")
criminalsite <- c("TY: Taoyuan District","JLI: Jhongli District",
                  "BD: Bade District","PJ: Pingjen District",
                  "GS: Gueishan District","LT: Longtan District",
                  "YM: Yangmei District","DS: Dasi District",
                  "LJ: Lujhu District","DY: Dayuan District",
                  "GY: Guanyin District","SW: Sinwu District",
                  "FS: Fusing District")
# 分別將案類、數量取出
crisite <- cridata0112_ty_site$Site
crisquan <- cridata0112_ty_site$Quantity
# 將數量資料轉成matrix
matrix_cridata0112_ty_site <- matrix(crisquan)
# 轉置matrix
matrix_cridata0112_ty_site <- t(matrix_cridata0112_ty_site)
# 更改欄位名
colnames(matrix_cridata0112_ty_site) <- crisite
# 各區域犯罪統計
knitr::kable(matrix_cridata0112_ty_site)
# 長條圖
barplot(matrix_cridata0112_ty_site, 
        xlab = "Taoyuan Areas",
        ylab = "Quantity",
        col = "#FF7256",
        legend.text = criminalsite,
        xpd = TRUE,
        width = 1, space = 0.1, main = "TaoYuan Various Areas Crime Statistics")
# 從上圖可以看出桃園市犯罪最高的行政區

# 2. 狹小巷弄資料
# 統計桃園各行政區狹小巷弄數量
# narrowalley_ty_site
narrowalley_ty_site <- data.frame(table(narrowalley_ty$Site))
# 更改欄位名稱: Site, Quantity
# 桃園市目前轄有12個區和1個直轄市山地原住民區
names(narrowalley_ty_site) <- c("Site","Quantity")
# 由大到小排序
narrowalley_ty_site <- narrowalley_ty_site[order(narrowalley_ty_site$Quantity, decreasing = TRUE),]
# 將Site欄位內容改為英文
narrowalley_ty_site$Site <- c("JLI","TY","BD","LJ",
                              "GS","PJ","LT","YM",
                              "DS","SW","DY","GY")
narrowalleysite <- c("JLI: Jhongli District","TY: Taoyuan District",
                  "BD: Bade District","LJ: Lujhu District",
                  "GS: Gueishan District","PJ: Pingjen District",
                  "LT: Longtan District","YM: Yangmei District",
                  "DS: Dasi District","SW: Sinwu District",
                  "DY: Dayuan District","GY: Guanyin District")
# 分別將區域、數量取出
narsite <- narrowalley_ty_site$Site
narquan <- narrowalley_ty_site$Quantity
# 將數量資料轉成matrix
matrix_narrowalley_ty_site <- matrix(narquan)
# 轉置matrix
matrix_narrowalley_ty_site <- t(matrix_narrowalley_ty_site)
# 更改欄位名
colnames(matrix_narrowalley_ty_site) <- narsite
# 各區域狹小巷弄統計
knitr::kable(matrix_narrowalley_ty_site)
# 長條圖
barplot(matrix_narrowalley_ty_site, 
        xlab = "Taoyuan Dist.",
        ylab = "Quantity",
        col = "#FF7256",
        legend.text = narrowalleysite,
        width = 5, 
        space = 0.1, 
        xpd = TRUE,
        main = "TaoYuan Narrow Alley Statistics")
# 從上圖可以看出桃園市擁有多狹小巷弄的行政區
```

## 期末專題分析規劃
以桃園市犯罪統計資料作為依據，來交叉比對出最少犯罪之居住區域。
以桃園市狹小巷弄資料作為依據，來交叉比對出未來(潛在危險)可能發生事件之空間。
最後期望透過分析過後可以找出讓民眾安全居住的區域。
另外，是否在政府資源越多的城市之中犯罪率越高呢？